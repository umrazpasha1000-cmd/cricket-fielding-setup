<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cricket Fielding Positions</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #1a472a;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .main-container {
            display: flex;
            gap: 20px;
            width: 100%;
            max-width: 1100px;
            align-items: flex-start;
        }

        .left-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .right-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        @media (max-width: 768px) {
            body {
                padding: 5px;
            }

            .main-container {
                flex-direction: column;
                align-items: center;
            }

            .left-section {
                width: 100%;
                max-width: 700px;
            }
        }

        h1 {
            color: white;
            margin-bottom: 20px;
            font-size: 28px;
            text-align: center;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 22px;
                margin-bottom: 10px;
            }
        }

        .controls {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 700px;
        }

        @media (max-width: 768px) {
            .controls {
                padding: 15px;
                margin-bottom: 15px;
            }
        }

        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 15px;
        }

        @media (max-width: 480px) {
            .input-group {
                flex-direction: column;
                width: 100%;
            }
        }

        .swap-btn {
            background-color: #0066cc;
            font-size: 14px;
        }

        .swap-btn:hover {
            background-color: #0052a3;
        }

        input[type="text"] {
            padding: 10px;
            border: 2px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
            width: 250px;
            max-width: 100%;
        }

        @media (max-width: 480px) {
            input[type="text"] {
                width: 100%;
            }
        }

        button {
            padding: 10px 20px;
            background-color: #2d7a4d;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #1f5436;
        }

        @media (max-width: 480px) {
            button {
                width: 100%;
            }
        }

        .field-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            aspect-ratio: 1 / 1;
            background: linear-gradient(135deg, #2d7a4d 0%, #1a5c35 100%);
            border-radius: 50%;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
            border: 4px solid white;
        }

        @media (max-width: 768px) {
            .field-container {
                max-width: 95vw;
                max-height: 95vw;
            }
        }

        .inner-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 42.86%;
            height: 42.86%;
            border: 3px dashed rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            z-index: 5;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .inner-circle {
                border-width: 2px;
            }
        }

        .pitch {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 3%;
            height: 11.5%;
            background-color: #d4a574;
            border: 2px solid #8b6f47;
            border-radius: 2px;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .pitch {
                border-width: 1px;
            }
        }

        .fielder {
            position: absolute;
            background-color: #ff6b35;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: move;
            user-select: none;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            transition: transform 0.1s;
            z-index: 1;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        @media (max-width: 768px) {
            .fielder {
                font-size: 10px;
                padding: 4px 6px;
                gap: 4px;
            }
        }

        .fielder:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .fielder.dragging {
            opacity: 0.7;
            z-index: 1000;
        }

        .remove-btn {
            background-color: rgba(255, 255, 255, 0.3);
            border: none;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            line-height: 1;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-btn:hover {
            background-color: rgba(255, 255, 255, 0.5);
        }

        @media (max-width: 768px) {
            .remove-btn {
                width: 16px;
                height: 16px;
                font-size: 10px;
            }
        }

        .center-marker {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            background-color: white;
            border-radius: 50%;
            z-index: 10;
            pointer-events: none;
        }

        .label {
            position: absolute;
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
            font-weight: bold;
        }

        .label-30yard {
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
        }

        .end-label {
            position: absolute;
            color: white;
            font-size: 16px;
            font-weight: bold;
            background-color: rgba(0, 0, 0, 0.4);
            padding: 8px 16px;
            border-radius: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .end-label {
                font-size: 13px;
                padding: 6px 12px;
            }
        }

        .bowler-end {
            bottom: 10px;
        }

        .keeper-end {
            top: 10px;
        }

        .info {
            color: white;
            margin-top: 15px;
            font-size: 14px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .info {
                font-size: 12px;
                margin-top: 10px;
            }
        }

        .players-list {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            min-width: 200px;
            max-height: 600px;
            overflow-y: auto;
        }

        .players-list::-webkit-scrollbar {
            width: 8px;
        }

        .players-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .players-list::-webkit-scrollbar-thumb {
            background: #2d7a4d;
            border-radius: 4px;
        }

        .players-list::-webkit-scrollbar-thumb:hover {
            background: #1a472a;
        }

        .players-list h3 {
            margin: 0 0 10px 0;
            font-size: 18px;
            color: #1a472a;
            border-bottom: 2px solid #2d7a4d;
            padding-bottom: 8px;
        }

        #teamSelect {
            width: 100%;
            padding: 8px;
            margin-bottom: 12px;
            border: 2px solid #2d7a4d;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
            color: #1a472a;
            background-color: white;
            cursor: pointer;
        }

        #teamSelect:focus {
            outline: none;
            border-color: #1a472a;
        }

        .player-item {
            background-color: #ff6b35;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: move;
            user-select: none;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            margin-bottom: 8px;
            text-align: center;
            transition: transform 0.1s;
        }

        .player-item:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .player-item.used {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* Mobile Team Selection Screen */
        .mobile-team-selection {
            display: none;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }

        .mobile-team-selection h2 {
            color: #1a472a;
            margin-bottom: 15px;
            text-align: center;
        }

        #mobileTeamSelect {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 2px solid #2d7a4d;
            border-radius: 4px;
            font-size: 15px;
            font-weight: bold;
            color: #1a472a;
            background-color: white;
            cursor: pointer;
        }

        #mobileTeamSelect:focus {
            outline: none;
            border-color: #1a472a;
        }

        .mobile-team-selection .selected-count {
            text-align: center;
            color: #2d7a4d;
            font-weight: bold;
            margin: 10px 0;
            font-size: 16px;
        }

        .mobile-player-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 15px 0;
            max-height: 60vh;
            overflow-y: auto;
        }

        .mobile-player-item {
            background-color: #f0f0f0;
            color: #1a472a;
            padding: 12px 6px;
            border-radius: 8px;
            text-align: center;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .mobile-player-item.selected {
            background-color: #ff6b35;
            color: white;
            border-color: #ff6b35;
        }

        .mobile-player-item:active {
            transform: scale(0.95);
        }

        .proceed-btn {
            width: 100%;
            padding: 15px;
            background-color: #2d7a4d;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
        }

        .proceed-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .back-to-selection-btn {
            display: none;
            width: 100%;
            max-width: 300px;
            padding: 10px;
            background-color: #0066cc;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px auto;
        }

        .back-to-selection-btn.visible {
            display: block;
        }

        .mobile-swap-btn {
            display: none;
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 24px;
            background-color: #0066cc;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .mobile-swap-btn.visible {
            display: block;
        }

        @media (max-width: 768px) {
            body {
                padding: 0;
            }

            h1 {
                font-size: 20px;
                margin-bottom: 5px;
                padding: 10px;
            }

            .players-list {
                width: 100%;
                max-height: 200px;
                padding: 12px;
            }

            .players-list h3 {
                font-size: 16px;
                margin-bottom: 8px;
            }

            #playersList {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
            }

            .player-item {
                font-size: 11px;
                padding: 8px 4px;
                text-align: center;
                margin-bottom: 0;
            }

            #teamSelect {
                font-size: 13px;
                padding: 6px;
                margin-bottom: 10px;
            }

            /* Show mobile selection, hide field initially */
            .mobile-team-selection {
                display: block;
            }

            .main-container {
                display: none;
            }

            .main-container.show-field {
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 100%;
                padding: 0;
            }

            .mobile-team-selection.hidden {
                display: none;
            }

            /* Hide controls and player list on mobile */
            .left-section {
                display: none;
            }

            .controls {
                display: none;
            }

            .info {
                display: none;
            }

            .right-section {
                width: 100%;
                padding: 0;
            }

            .field-container {
                width: 100vw !important;
                height: 100vw !important;
                max-width: 100vw !important;
                max-height: 100vw !important;
                margin: 0;
            }

            .mobile-player-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .back-to-selection-btn {
                margin: 5px auto;
                position: fixed;
                top: 5px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 100;
            }
        }

        @media (max-width: 480px) {
            #playersList {
                grid-template-columns: repeat(2, 1fr);
            }

            .player-item {
                font-size: 10px;
                padding: 7px 3px;
            }

            .mobile-player-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .mobile-player-item {
                font-size: 11px;
                padding: 10px 4px;
            }
        }
    </style>
</head>
<body>
    <h1>Cricket Fielding Positions</h1>

    <!-- Mobile Team Selection Screen -->
    <div class="mobile-team-selection" id="mobileSelection">
        <h2>Select Team & Playing 11</h2>

        <select id="mobileTeamSelect" onchange="loadMobilePlayers(this.value)">
            <option value="DECCAN FIGHTERS">DECCAN FIGHTERS</option>
            <option value="TIPPU FIGHTERS">TIPPU FIGHTERS</option>
            <option value="ROYAL SULTHANS">ROYAL SULTHANS</option>
            <option value="SULTHANS STRIKERS">SULTHANS STRIKERS</option>
            <option value="ROYAL TITANS">ROYAL TITANS</option>
        </select>

        <div class="selected-count">
            Selected: <span id="selectedCount">0</span>/11
        </div>

        <div class="mobile-player-grid" id="mobilePlayerGrid"></div>

        <button class="proceed-btn" id="proceedBtn" onclick="proceedToField()" disabled>
            Proceed to Field Setup
        </button>
    </div>

    <button class="back-to-selection-btn" id="backBtn" onclick="backToSelection()">
        ← Change Team/Players
    </button>

    <button class="mobile-swap-btn" id="mobileSwapBtn" onclick="swapEnds()">
        ⇅ Swap Ends
    </button>

    <div class="main-container">
        <div class="left-section">
            <div class="players-list">
                <h3>Players</h3>
                <select id="teamSelect" onchange="changeTeam(this.value)">
                    <option value="DECCAN FIGHTERS">DECCAN FIGHTERS</option>
                    <option value="TIPPU FIGHTERS">TIPPU FIGHTERS</option>
                    <option value="ROYAL SULTHANS">ROYAL SULTHANS</option>
                    <option value="SULTHANS STRIKERS">SULTHANS STRIKERS</option>
                    <option value="ROYAL TITANS">ROYAL TITANS</option>
                </select>
                <div id="playersList"></div>
            </div>
        </div>

        <div class="right-section">
            <div class="controls">
                <div class="input-group">
                    <input type="text" id="playerName" placeholder="Enter player name" />
                    <button onclick="addFielder()">Add Fielder</button>
                </div>
                <div class="input-group" style="margin-bottom: 0;">
                    <button class="swap-btn" onclick="swapEnds()">⇅ Swap Ends</button>
                </div>
            </div>

            <div class="field-container" id="fieldContainer">
                <div class="end-label bowler-end">Bowler End</div>
                <div class="end-label keeper-end">Keeper End</div>
                <div class="inner-circle">
                    <span class="label label-30yard">30 Yard Circle</span>
                </div>
                <div class="pitch"></div>
                <div class="center-marker"></div>
            </div>

            <div class="info">
                Click "Add Fielder" to place a player, then drag them to position
            </div>
        </div>
    </div>

    <script>
        let draggedElement = null;
        let offsetX = 0;
        let offsetY = 0;
        let fielderCount = 0;
        let endsSwapped = false;

        // Teams data
        const teamsData = {
            'DECCAN FIGHTERS': [
                'IMRAN K', 'ROSHAN', 'KULLU', 'AMANULLA', 'ALEEM',
                'SHAMSHEER', 'GORU', 'CHANDAN', 'IRFAN', 'YUSUF',
                'SHAFU', 'SIRAJ', 'JAI KUMAR', 'ALTAF', 'JILAN'
            ],
            'TIPPU FIGHTERS': [
                'FIRDOS', 'ANJUM', 'SYED KAZIM', 'INJUMAM ULLAK', 'SYED KAIF',
                'YAKEEN', 'IMRAN T', 'UMRAZ', 'YARAB', 'WASIM',
                'AFROZ', 'SAAD', 'RIZWAN PASHA', 'SYED JUNAID', 'ZAMEER'
            ],
            'ROYAL SULTHANS': [
                'FAYAZ', 'MUJJU', 'SYED NIZAM', 'DHARMA', 'MANJU G',
                'PARVEEZ', 'IMRAN B', 'NITHIN', 'MANJA BULLET', 'SYED KHAJA',
                'TALIB', 'TANNU', 'AMAR GOWDA', 'SYED NAVEED', 'SYED HARIS', 'SALMAN'
            ],
            'SULTHANS STRIKERS': [
                'SADIQ', 'CHAND BHAI', 'UMRAZ', 'KHALANDAR', 'MUZAMMIL',
                'CHAND PASHA M', 'NIZAM BT', 'SHOIB', 'SYED DOULATH', 'AFNAN',
                'AZHAR', 'ZABI', 'MANSOOR BAIG', 'ANAND ANNA', 'BABAR'
            ],
            'ROYAL TITANS': [
                'MOHSIN', 'SACHIN', 'SALIM', 'TABREZ', 'MANSOOR PASHA',
                'NAYAZ', 'ADDU', 'FAKRU', 'YASEEN', 'RAZBI',
                'SHABAZ', 'FAIZ', 'ASIF', 'RIYAZ', 'ZABI CHIT'
            ]
        };

        let currentTeam = 'DECCAN FIGHTERS';
        let defaultPlayers = teamsData[currentTeam];
        let selectedPlayers = [];

        // Mobile selection functions
        function loadMobilePlayers(teamName) {
            currentTeam = teamName;
            selectedPlayers = [];

            const grid = document.getElementById('mobilePlayerGrid');
            grid.innerHTML = '';

            teamsData[teamName].forEach((playerName, index) => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'mobile-player-item';
                playerDiv.textContent = playerName;

                // Auto-select first 11 players
                if (index < 11) {
                    playerDiv.classList.add('selected');
                    selectedPlayers.push(playerName);
                }

                playerDiv.onclick = function() {
                    togglePlayerSelection(playerName, playerDiv);
                };
                grid.appendChild(playerDiv);
            });

            updateSelectedCount();
        }

        function togglePlayerSelection(playerName, element) {
            const index = selectedPlayers.indexOf(playerName);

            if (index > -1) {
                // Deselect
                selectedPlayers.splice(index, 1);
                element.classList.remove('selected');
            } else {
                // Select (only if less than 11)
                if (selectedPlayers.length < 11) {
                    selectedPlayers.push(playerName);
                    element.classList.add('selected');
                }
            }

            updateSelectedCount();
        }

        function updateSelectedCount() {
            document.getElementById('selectedCount').textContent = selectedPlayers.length;
            const proceedBtn = document.getElementById('proceedBtn');
            proceedBtn.disabled = selectedPlayers.length !== 11;
        }

        function proceedToField() {
            // Update the default players to only selected ones
            defaultPlayers = selectedPlayers;

            // Hide mobile selection, show field
            document.getElementById('mobileSelection').classList.add('hidden');
            document.querySelector('.main-container').classList.add('show-field');
            document.getElementById('backBtn').classList.add('visible');
            document.getElementById('mobileSwapBtn').classList.add('visible');

            // Update the desktop team selector
            document.getElementById('teamSelect').value = currentTeam;

            // Auto-place all selected players on the field for mobile
            setTimeout(() => {
                const fieldContainer = document.getElementById('fieldContainer');
                const containerRect = fieldContainer.getBoundingClientRect();
                const radius = (containerRect.width / 2) * 0.75; // 75% of radius
                const centerX = containerRect.width / 2;
                const centerY = containerRect.height / 2;

                selectedPlayers.forEach((playerName, index) => {
                    const fielder = document.createElement('div');
                    fielder.className = 'fielder';
                    fielder.id = 'fielder-' + fielderCount++;

                    const nameSpan = document.createElement('span');
                    nameSpan.textContent = playerName;

                    fielder.appendChild(nameSpan);

                    // Position players in a circle - start from top (270 degrees) and go clockwise
                    const angle = (Math.PI * 1.5) + (index / selectedPlayers.length) * 2 * Math.PI;
                    const x = centerX + radius * Math.cos(angle);
                    const y = centerY + radius * Math.sin(angle);

                    fielder.style.left = x + 'px';
                    fielder.style.top = y + 'px';
                    fielder.style.transform = 'translate(-50%, -50%)';

                    // Add drag event listeners
                    fielder.addEventListener('mousedown', startDrag);
                    fielder.addEventListener('touchstart', startDrag);

                    fieldContainer.appendChild(fielder);
                });
            }, 100); // Small delay to ensure container is rendered
        }

        function backToSelection() {
            // Clear all fielders from the field
            const fielders = document.querySelectorAll('.fielder');
            fielders.forEach(fielder => fielder.remove());

            // Show mobile selection, hide field
            document.getElementById('mobileSelection').classList.remove('hidden');
            document.querySelector('.main-container').classList.remove('show-field');
            document.getElementById('backBtn').classList.remove('visible');
            document.getElementById('mobileSwapBtn').classList.remove('visible');
        }

        // Initialize mobile view on load
        window.addEventListener('DOMContentLoaded', function() {
            if (window.innerWidth <= 768) {
                loadMobilePlayers('DECCAN FIGHTERS');
            } else {
                initPlayersList();
            }
        });

        // Initialize players list
        function initPlayersList() {
            const playersList = document.getElementById('playersList');
            playersList.innerHTML = ''; // Clear existing players
            defaultPlayers.forEach(playerName => {
                const playerItem = document.createElement('div');
                playerItem.className = 'player-item';
                playerItem.textContent = playerName;
                playerItem.dataset.playerName = playerName;
                playerItem.addEventListener('mousedown', startDragFromList);
                playerItem.addEventListener('touchstart', startDragFromList);
                playersList.appendChild(playerItem);
            });
        }

        // Change team
        function changeTeam(teamName) {
            currentTeam = teamName;
            defaultPlayers = teamsData[teamName];

            // Clear all fielders from the field
            const fielders = document.querySelectorAll('.fielder');
            fielders.forEach(fielder => fielder.remove());

            // Reload players list
            initPlayersList();
        }

        // Add fielder function
        function addFielder() {
            const nameInput = document.getElementById('playerName');
            const name = nameInput.value.trim();

            if (name === '') {
                alert('Please enter a player name');
                return;
            }

            const fieldContainer = document.getElementById('fieldContainer');
            const fielder = document.createElement('div');
            fielder.className = 'fielder';
            fielder.id = 'fielder-' + fielderCount++;

            // Create name span
            const nameSpan = document.createElement('span');
            nameSpan.textContent = name;

            // Create remove button
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-btn';
            removeBtn.innerHTML = '&times;';
            removeBtn.dataset.playerName = name;

            const removeFielder = function(e) {
                e.stopPropagation();
                e.preventDefault();
                // Mark list item as unused if player exists in list
                const playerListItem = document.querySelector(`[data-player-name="${name}"]`);
                if (playerListItem) {
                    playerListItem.classList.remove('used');
                }
                fielder.remove();
            };

            removeBtn.addEventListener('click', removeFielder);
            removeBtn.addEventListener('touchstart', removeFielder, {passive: false});

            fielder.appendChild(nameSpan);
            fielder.appendChild(removeBtn);

            // Position fielder at center initially
            const containerRect = fieldContainer.getBoundingClientRect();
            fielder.style.left = (containerRect.width / 2) + 'px';
            fielder.style.top = (containerRect.height / 2) + 'px';
            fielder.style.transform = 'translate(-50%, -50%)';

            // Add drag event listeners
            fielder.addEventListener('mousedown', startDrag);
            fielder.addEventListener('touchstart', startDrag);

            fieldContainer.appendChild(fielder);

            // Clear input
            nameInput.value = '';
            nameInput.focus();
        }

        // Allow Enter key to add fielder
        document.getElementById('playerName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addFielder();
            }
        });

        // Swap ends function
        function swapEnds() {
            endsSwapped = !endsSwapped;
            const bowlerLabel = document.querySelector('.bowler-end');
            const keeperLabel = document.querySelector('.keeper-end');

            if (endsSwapped) {
                bowlerLabel.textContent = 'Bowler End';
                keeperLabel.textContent = 'Keeper End';
                bowlerLabel.style.top = '10px';
                bowlerLabel.style.bottom = 'auto';
                keeperLabel.style.bottom = '10px';
                keeperLabel.style.top = 'auto';
            } else {
                bowlerLabel.textContent = 'Bowler End';
                keeperLabel.textContent = 'Keeper End';
                bowlerLabel.style.bottom = '10px';
                bowlerLabel.style.top = 'auto';
                keeperLabel.style.top = '10px';
                keeperLabel.style.bottom = 'auto';
            }
        }

        // Drag from players list
        function startDragFromList(e) {
            const listItem = this;

            // Check if already used
            if (listItem.classList.contains('used')) {
                return;
            }

            // Check if the touch/click is on the remove button
            if (e.target.classList.contains('remove-btn') || e.target.closest('.remove-btn')) {
                return; // Don't start dragging if clicking remove button
            }

            e.preventDefault();

            // Create a new fielder on the field
            const fieldContainer = document.getElementById('fieldContainer');
            const fielder = document.createElement('div');
            fielder.className = 'fielder';
            fielder.id = 'fielder-' + fielderCount++;

            const nameSpan = document.createElement('span');
            nameSpan.textContent = listItem.dataset.playerName;

            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-btn';
            removeBtn.innerHTML = '&times;';

            const removeFielder = function(e) {
                e.stopPropagation();
                e.preventDefault();
                // Mark list item as unused
                const playerName = listItem.dataset.playerName;
                const playerListItem = document.querySelector(`[data-player-name="${playerName}"]`);
                if (playerListItem) {
                    playerListItem.classList.remove('used');
                }
                fielder.remove();
            };

            removeBtn.addEventListener('click', removeFielder);
            removeBtn.addEventListener('touchstart', removeFielder, {passive: false});

            fielder.appendChild(nameSpan);
            fielder.appendChild(removeBtn);

            // Position at center initially
            const containerRect = fieldContainer.getBoundingClientRect();
            fielder.style.left = (containerRect.width / 2) + 'px';
            fielder.style.top = (containerRect.height / 2) + 'px';
            fielder.style.transform = 'translate(-50%, -50%)';

            // Add to field
            fieldContainer.appendChild(fielder);

            // Mark as used
            listItem.classList.add('used');

            // Start dragging immediately
            draggedElement = fielder;
            draggedElement.classList.add('dragging');

            const rect = fielder.getBoundingClientRect();
            const clientX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
            const clientY = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;

            offsetX = clientX - rect.left - rect.width / 2;
            offsetY = clientY - rect.top - rect.height / 2;

            // Add drag event listeners for the fielder
            fielder.addEventListener('mousedown', startDrag);
            fielder.addEventListener('touchstart', startDrag);

            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchmove', drag);
            document.addEventListener('touchend', stopDrag);
        }

        // Drag functions
        function startDrag(e) {
            // Check if the touch/click is on the remove button
            if (e.target.classList.contains('remove-btn') || e.target.closest('.remove-btn')) {
                return; // Don't start dragging if clicking remove button
            }

            e.preventDefault();
            draggedElement = this;
            draggedElement.classList.add('dragging');

            const rect = draggedElement.getBoundingClientRect();
            const clientX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
            const clientY = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;

            offsetX = clientX - rect.left - rect.width / 2;
            offsetY = clientY - rect.top - rect.height / 2;

            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchmove', drag);
            document.addEventListener('touchend', stopDrag);
        }

        function drag(e) {
            if (!draggedElement) return;

            const fieldContainer = document.getElementById('fieldContainer');
            const containerRect = fieldContainer.getBoundingClientRect();

            const clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
            const clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;

            let x = clientX - containerRect.left - offsetX;
            let y = clientY - containerRect.top - offsetY;

            // Constrain to circle
            const centerX = containerRect.width / 2;
            const centerY = containerRect.height / 2;
            const radius = containerRect.width / 2 - 20; // Leave some margin

            const dx = x - centerX;
            const dy = y - centerY;
            const distance = Math.sqrt(dx * dx + dy * dy);

            if (distance > radius) {
                const angle = Math.atan2(dy, dx);
                x = centerX + radius * Math.cos(angle);
                y = centerY + radius * Math.sin(angle);
            }

            draggedElement.style.left = x + 'px';
            draggedElement.style.top = y + 'px';
        }

        function stopDrag() {
            if (draggedElement) {
                draggedElement.classList.remove('dragging');
                draggedElement = null;
            }

            document.removeEventListener('mousemove', drag);
            document.removeEventListener('mouseup', stopDrag);
            document.removeEventListener('touchmove', drag);
            document.removeEventListener('touchend', stopDrag);
        }
    </script>
</body>
</html>
